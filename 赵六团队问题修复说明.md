# èµµå…­å›¢é˜Ÿå®¢æˆ·æ˜¾ç¤ºé—®é¢˜ä¿®å¤è¯´æ˜

## ğŸ” é—®é¢˜æè¿°
- **ç”¨æˆ·**: èµµå…­ (ç»„é•¿)
- **é—®é¢˜**: æ— æ³•çœ‹åˆ°ä¸‹çº§å‘˜å·¥é’±ä¸ƒçš„å®¢æˆ·æå››
- **æ ¹æœ¬åŸå› **: èµµå…­åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰å¯¹åº”çš„å›¢é˜Ÿè®°å½•

## ğŸ“Š é—®é¢˜åˆ†æ
ä»è°ƒè¯•æ—¥å¿—å¯ä»¥çœ‹å‡ºï¼š
1. èµµå…­çš„ç”¨æˆ·ID: `550e8400-e29b-41d4-a716-446655440013`
2. ç³»ç»Ÿä¸­æœ‰2ä¸ªå›¢é˜Ÿï¼Œä½†èµµå…­ä¸æ˜¯ä»»ä½•å›¢é˜Ÿçš„ç»„é•¿
3. `getSubordinates` æ–¹æ³•è¿”å›ç©ºæ•°ç»„
4. æ²¡æœ‰ä¸‹çº§å‘˜å·¥ â†’ æ²¡æœ‰å›¢é˜Ÿå®¢æˆ·

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: ä½¿ç”¨å¿«é€Ÿä¿®å¤è„šæœ¬
1. åœ¨Supabaseæ§åˆ¶å°çš„SQLç¼–è¾‘å™¨ä¸­æ‰§è¡Œ `quick_fix_zhaoliu.sql`
2. æŒ‰æ­¥éª¤æ‰§è¡Œï¼Œå…ˆæŸ¥çœ‹æ•°æ®ï¼Œå†åˆ›å»ºå›¢é˜Ÿ
3. æ‰‹åŠ¨åˆ†é…é’±ä¸ƒåˆ°èµµå…­çš„å›¢é˜Ÿ

### æ–¹æ¡ˆ2: æ‰‹åŠ¨æ‰§è¡ŒSQL
```sql
-- 1. ä¸ºèµµå…­åˆ›å»ºå›¢é˜Ÿ
INSERT INTO teams (id, name, leader_id, created_at)
VALUES (gen_random_uuid(), 'èµµå…­å›¢é˜Ÿ', '550e8400-e29b-41d4-a716-446655440013', NOW());

-- 2. è·å–æ–°å›¢é˜ŸID
SELECT id FROM teams WHERE leader_id = '550e8400-e29b-41d4-a716-446655440013';

-- 3. å°†é’±ä¸ƒåˆ†é…åˆ°å›¢é˜Ÿï¼ˆéœ€è¦é’±ä¸ƒçš„å®é™…ç”¨æˆ·IDï¼‰
UPDATE users SET team_id = 'æ–°å›¢é˜ŸID' WHERE id = 'é’±ä¸ƒçš„ç”¨æˆ·ID';
```

## ğŸ“ æ‰§è¡Œæ­¥éª¤

### ç¬¬ä¸€æ­¥: æŸ¥çœ‹å½“å‰æ•°æ®
```sql
SELECT id, name, leader_id FROM teams;
SELECT id, name, role, team_id FROM users WHERE role IN ('team_leader', 'employee');
```

### ç¬¬äºŒæ­¥: åˆ›å»ºèµµå…­çš„å›¢é˜Ÿ
```sql
INSERT INTO teams (id, name, leader_id, created_at)
VALUES (gen_random_uuid(), 'èµµå…­å›¢é˜Ÿ', '550e8400-e29b-41d4-a716-446655440013', NOW());
```

### ç¬¬ä¸‰æ­¥: æ‰¾åˆ°é’±ä¸ƒçš„ç”¨æˆ·ID
```sql
SELECT id, name, role, team_id FROM users WHERE name LIKE '%é’±%' OR name LIKE '%7%';
```

### ç¬¬å››æ­¥: åˆ†é…é’±ä¸ƒåˆ°èµµå…­çš„å›¢é˜Ÿ
```sql
-- æ›¿æ¢ 'é’±ä¸ƒçš„ç”¨æˆ·ID' ä¸ºå®é™…ID
UPDATE users SET team_id = (SELECT id FROM teams WHERE leader_id = '550e8400-e29b-41d4-a716-446655440013') 
WHERE id = 'é’±ä¸ƒçš„ç”¨æˆ·ID';
```

### ç¬¬äº”æ­¥: éªŒè¯ä¿®å¤ç»“æœ
```sql
SELECT 
    t.name as team_name,
    t.leader_id,
    u.name as member_name,
    u.role
FROM teams t
LEFT JOIN users u ON u.team_id = t.id
WHERE t.leader_id = '550e8400-e29b-41d4-a716-446655440013';
```

## âœ… éªŒè¯ä¿®å¤
ä¿®å¤å®Œæˆåï¼Œåˆ·æ–°ç»„é•¿ç®¡ç†é¡µé¢ï¼Œåº”è¯¥èƒ½çœ‹åˆ°ï¼š
1. èµµå…­æœ‰ä¸‹çº§å‘˜å·¥ï¼ˆé’±ä¸ƒï¼‰
2. èµµå…­èƒ½çœ‹åˆ°é’±ä¸ƒçš„å®¢æˆ·æå››
3. "å¾…å®¡æ‰¹" æ•°é‡æ­£ç¡®æ˜¾ç¤º
4. "å›¢é˜Ÿå®¢æˆ·" é¡µé¢æ˜¾ç¤ºæå››

## ğŸ” è°ƒè¯•ä¿¡æ¯
å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ä¸­çš„ï¼š
- `subordinateIds` åº”è¯¥ä¸å†æ˜¯ç©ºæ•°ç»„
- `teamCustomersFiltered` åº”è¯¥æ˜¾ç¤ºå®¢æˆ·æ•°æ®
- `filteredCustomersDetails` åº”è¯¥åŒ…å«æå››çš„ä¿¡æ¯

