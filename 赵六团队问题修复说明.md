# 赵六团队客户显示问题修复说明

## 🔍 问题描述
- **用户**: 赵六 (组长)
- **问题**: 无法看到下级员工钱七的客户李四
- **根本原因**: 赵六在数据库中没有对应的团队记录

## 📊 问题分析
从调试日志可以看出：
1. 赵六的用户ID: `550e8400-e29b-41d4-a716-446655440013`
2. 系统中有2个团队，但赵六不是任何团队的组长
3. `getSubordinates` 方法返回空数组
4. 没有下级员工 → 没有团队客户

## 🔧 解决方案

### 方案1: 使用快速修复脚本
1. 在Supabase控制台的SQL编辑器中执行 `quick_fix_zhaoliu.sql`
2. 按步骤执行，先查看数据，再创建团队
3. 手动分配钱七到赵六的团队

### 方案2: 手动执行SQL
```sql
-- 1. 为赵六创建团队
INSERT INTO teams (id, name, leader_id, created_at)
VALUES (gen_random_uuid(), '赵六团队', '550e8400-e29b-41d4-a716-446655440013', NOW());

-- 2. 获取新团队ID
SELECT id FROM teams WHERE leader_id = '550e8400-e29b-41d4-a716-446655440013';

-- 3. 将钱七分配到团队（需要钱七的实际用户ID）
UPDATE users SET team_id = '新团队ID' WHERE id = '钱七的用户ID';
```

## 📝 执行步骤

### 第一步: 查看当前数据
```sql
SELECT id, name, leader_id FROM teams;
SELECT id, name, role, team_id FROM users WHERE role IN ('team_leader', 'employee');
```

### 第二步: 创建赵六的团队
```sql
INSERT INTO teams (id, name, leader_id, created_at)
VALUES (gen_random_uuid(), '赵六团队', '550e8400-e29b-41d4-a716-446655440013', NOW());
```

### 第三步: 找到钱七的用户ID
```sql
SELECT id, name, role, team_id FROM users WHERE name LIKE '%钱%' OR name LIKE '%7%';
```

### 第四步: 分配钱七到赵六的团队
```sql
-- 替换 '钱七的用户ID' 为实际ID
UPDATE users SET team_id = (SELECT id FROM teams WHERE leader_id = '550e8400-e29b-41d4-a716-446655440013') 
WHERE id = '钱七的用户ID';
```

### 第五步: 验证修复结果
```sql
SELECT 
    t.name as team_name,
    t.leader_id,
    u.name as member_name,
    u.role
FROM teams t
LEFT JOIN users u ON u.team_id = t.id
WHERE t.leader_id = '550e8400-e29b-41d4-a716-446655440013';
```

## ✅ 验证修复
修复完成后，刷新组长管理页面，应该能看到：
1. 赵六有下级员工（钱七）
2. 赵六能看到钱七的客户李四
3. "待审批" 数量正确显示
4. "团队客户" 页面显示李四

## 🔍 调试信息
如果问题仍然存在，请查看控制台日志中的：
- `subordinateIds` 应该不再是空数组
- `teamCustomersFiltered` 应该显示客户数据
- `filteredCustomersDetails` 应该包含李四的信息

